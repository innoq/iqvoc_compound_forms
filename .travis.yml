language: ruby
cache: bundler
bundler_args:
rvm:
- 2.4
- 2.5
- ruby-head
env:
- DB=sqlite
- DB=mysql
- DB=postgresql
before_install:
- cp config/database.$DB.yml config/database.yml
- gem update bundler
before_script:
- bundle exec rake db:drop RAILS_ENV=test
- bundle exec rake db:create RAILS_ENV=test
- bundle exec rake db:migrate RAILS_ENV=test
branches:
  only:
  - master
notifications:
  email: true
  slack:
    secure: cjByKgPesQK/vgLVIOPVZBqSchhIgX7wXyXsCqnS9gcJsqLaZWaC4pZ4iNXQ8m/shYsFa6EFoNfdGUKol2D26p0+eyji3Gol5r6VqPucGuQNU0jeHYc2fEgCm6EvcwtmIYY+cPL1xtFkOaaYvvzgWzI9A2DW3+ADjj45kDTGlwE=
    on_success: change
    on_failure: always
    on_pull_requests: false
deploy:
  provider: rubygems
  api_key:
    secure: maEhwWkTskmPRX1BdqJXrpnKrtTKrBGoho33oFn70OD+Z51vHYuZxz5SYUyzEG/uL2R5QFlIReUFtibpnSZx1xvTnqZyxMWY8gvRaOhrgmGoKmGvtbqF9zABTv7K/ivY5Kkt6jo3jahvf4/eQ+bWKCnA0Ak1JpuWhbgxZY8hUGY=
  gem: iqvoc_compound_forms
  on:
    tags: true
    repo: innoq/iqvoc_compound_forms
matrix:
  allow_failures:
  - rvm: ruby-head
